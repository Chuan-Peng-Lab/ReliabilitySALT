---
title: "6_Description"
author: "yuki"
date: "2023-07-07"
output: html_document
---
```{r}
library(bruceR)
library(utils)
```


```{r}
desc <- list()
```

```{r}
desc[[1]] <- read.csv("./Label.csv") %>%
  dplyr::select(Paper_ID, Sample_Size, Trials)
names(desc)[1] <- "Label"
```


################################################################################
--------------------------------------------------------------------------------
################################################################################


# nmshr
```{r}
# Trial number of each df
trial_num <- list()
for (i in 1:18) {
  temp <- df[[i]] %>%
    dplyr::group_by(Subject, Matching, Identity, Session) %>%
    dplyr::summarise(n = n())

  trial_num[[i]] <- max(temp$n)
}
desc[[2]] <- trial_num
names(desc)[2] <- "Number of Trial"
rm(trial_num)

# Subject number of each df
sub_num <- list()
for (i in 1:18) {
  temp <- df[[i]] %>%
    dplyr::distinct(Subject) %>%
    dplyr::summarise(n = n())

  sub_num[[i]] <- max(temp$n)
}
desc[[3]] <- sub_num
names(desc)[3] <- "Number of Subject"
rm(sub_num)

rm(temp, i)
```

```{r}
desc[[4]] <- plot[[1]] %>%
  dplyr::filter(Target == "Close" | Target == "Stranger") %>%
  dplyr::group_by(Target, Indice, Method) %>%
  dplyr::summarise(mean_r = mean(r),
                   sd_r = sd(r)) 
names(desc)[4] <- "nmshr Description"
```

```{r}
temp <- plot[[1]] %>%
  dplyr::filter(Target == "Close" | Target == "Stranger") %>%
  dplyr::mutate(Target = factor(Target, levels = c("Close", "Stranger"))) %>%
  base::split(.$Indice) 

for (i in 1:length(temp)) {
  output <- utils::capture.output({
    bruceR::TTEST(data = temp[[i]],
                  x = "Target",
                  y = "r")
  })
  path <- paste0("./OUTPUT/TTEST/", names(temp[i]), ".md")
  writeLines(output, path)
}

rm(temp, i, path)
```


################################################################################
--------------------------------------------------------------------------------
################################################################################


# mcshr
```{r}
desc[[5]] <- plot[[2]] %>%
  dplyr::filter(Target == "Close" | Target == "Stranger") %>%
  dplyr::group_by(Target, Indice) %>%
  dplyr::summarise(mean_r = mean(r),
                   mean_LLCI = mean(LLCI),
                   mean_ULCI = mean(ULCI)) 
names(desc)[5] <- "mcshr Description"
```

```{r}
temp <- plot[[2]] %>%
  dplyr::filter(Target == "Close" | Target == "Stranger") %>%
  dplyr::mutate(Target = factor(Target, levels = c("Close", "Stranger"))) %>%
  base::split(.$Indice) 

for (i in 1:length(temp)) {
  output <- utils::capture.output({
    bruceR::TTEST(data = temp[[i]],
                  x = "Target",
                  y = "r")
  })
  path <- paste0("./OUTPUT/TTEST/", names(temp[i]), ".md")
  writeLines(output, path)
}

rm(temp, i, path)
```


################################################################################
--------------------------------------------------------------------------------
################################################################################


# ICC
```{r}
desc[[6]] <- plot[[3]] 
names(desc)[6] <- "ICC Description"
```

