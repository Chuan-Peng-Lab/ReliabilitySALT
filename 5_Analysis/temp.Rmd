---
title: "Untitled"
author: "yuki"
date: "2024-03-14"
output: html_document
---
```{r}
ggplot2::ggplot(out[[1]][[1]], aes(x = yi_r , y = reorder(Unique_ID, Order))) +
  ggplot2::geom_vline(xintercept = 0, linetype = "solid", color = "grey20", linewidth = 0.5) +
  ggplot2::geom_vline(xintercept = 0.467, linetype = "dashed", color = "grey20", linewidth = 0.5) +
  ggplot2::geom_errorbar(aes(xmin = LLCI, xmax = ULCI), linewidth = 1, width = 0.3) +
  ggplot2::geom_point(shape =15, size = 5) +
  ggplot2::annotate("text", x = -3.5, y = 0, label = "Random Effect (n = 14)", hjust = 0, family='serif',fontface = "bold", size = 7) +
  ggplot2::annotate("text", x = -1.2, y = 0, label = "0.467 (0.300, 0.634)", hjust = 0.5, family='serif',fontface = "bold", size = 7) +
  ggplot2::annotate("text", x = 2.3, y = 0, label = "<.001", hjust = 0.5, family='serif',fontface = "bold", size = 7) +
  ggplot2::annotate("text", x = 0, y = -0.7, label = "") +
  #ggplot2::geom_errorbar(aes(xmin = 0.16, xmax = 1.15, y = 0), color = "#6499E9", linewidth = 1, width = 0.1) + # Fixed Effect CI
  #ggplot2::geom_point(aes(x = 0.66, y = 0), color = "#6499E9", shape = 18, size = 12) + # Fixed Effect Point
  ggplot2::geom_polygon(
    data = data.frame(x = c(0.300, 0.467, 0.634, 0.467), y = c(0, 0.20, 0, -0.20)),
    aes(x = x, y = y),
    fill = "#6499E9", color = "#6499E9"
  ) +
  ggplot2::geom_text(aes(x = -3.5, y = reorder(Unique_ID, Order), label = reorder(Unique_ID, Order)), size = 7, hjust = 0, family='serif',) + # Author_Year_Study
  ggplot2::geom_text(aes(x = -1.2, y = reorder(Unique_ID, Order), label = CI), size = 7, hjust = 0.5, family='serif',) + # CI
  ggplot2::geom_text(aes(x = 2.3, y = reorder(Unique_ID, Order), label = pval), size = 7, hjust = 0.5, family='serif',) +
  ggplot2::scale_x_continuous(
    limits = c(-3.5, 2.5), 
    breaks = seq(-0.5,2, by = 0.5),
    sec.axis = sec_axis(
      ~., 
      breaks = c(-2.9, -1.2, 2.3),
      labels = c("Author(s), Year and Study", "SMD (95%-CI)", expression(italic(p) * "-value"))
    ),
  ) +
  ggplot2::labs(x = "") +
  #ggplot2::ggtitle("Forest Plot") +
  papaja::theme_apa() +
  ggplot2::theme(
    legend.position = "none",
    axis.line.x = element_line(linewidth = 1.5),
    axis.title.x = element_text(size = 15, family='serif', hjust = 0.55),
    axis.text.x= element_text(size = 20, family='serif', face = "bold"),
    plot.title = element_text(size = 20, family='serif', face = "bold", hjust = 0),
    legend.key.width = unit(2, "cm"),
    legend.key.height = unit(5, "cm"),
    legend.text = element_text(size = 20, family='serif'),
    legend.title = element_blank(),
    axis.line.y = element_blank(),
    axis.ticks.y= element_blank(),
    axis.ticks.x.top = element_blank(),
    axis.text.y= element_blank(),
    axis.title.y= element_blank(),
  ) 

ggsave(filename = "./FIGURE/Forest.png", width = 16, height = 9, limitsize = FALSE)
```