---
title: "5_Plot"
author: "yuki"
date: "2023-05-04"
output: html_document
---
# Create NULL List
```{r Create NULL List}
plot <- list()
```

# Palette
```{r Palette}
warm <- c("#C848B9", "#F962A7","#F3533A", "#FD836D","#FA9F42", "#FFBA69")
cold <- c("#057748", "#3D9A8B", "#2EB19F", "#5ACFC9", "#63C2D2", "#B7EDFF")
palette <- list(warm = warm, cold = cold)
rm(warm, cold)
```

# SHR
```{r Plot SHR, message= FALSE, warning = FALSE}
# only for testing codes
nmshr.fake <- read.csv("../OUTPUT/plot_nmshr_fake.csv")

plot[[1]] <- ggplot2::ggplot(nmshr.fake, aes(x = Indice, y = r, fill = interaction(Indice, Target))) +
  ggplot2::geom_boxplot(width = 0.1, position = position_nudge(x = -0.05), color = "grey", alpha = 0.5, outlier.color = NA,) + 
  ggdist::stat_halfeye(adjust = 0.2,justification = -0.05, alpha = 0.5, width = 0.5, .width = 0, point_colour = NA) +
  ggdist::stat_dots(side = "left",justification = 1.15, alpha = 0.5) +
  ggplot2::coord_flip() + #flips the x and y axes of a plot
  ggplot2::scale_y_continuous(limits = c(0, 1), 
                     sec.axis = sec_axis(~., breaks = c(0.3, 0.5, 0.7, 1), 
                                             labels = c("unacceptable", "poor", "acceptable", "excellent")),
                                             breaks = seq(0,1,by = 0.1)) +
  ggplot2::geom_hline(yintercept = 0.3, linetype = "dotted", color = "black", size = 1, alpha = 0.5) + 
  ggplot2::geom_hline(yintercept = 0.5, linetype = "dotted", color = "black", size = 1, alpha = 0.5) + #add dotted line
  ggplot2::geom_hline(yintercept = 0.7, linetype = "dotted", color = "black", size = 1, alpha = 0.5) +
  ggplot2::geom_hline(yintercept = 1, linetype = "dotted", color = "black", size = 1, alpha = 0.5) +
  ggplot2::theme_bw() + #background white
  ggplot2::theme(legend.position = "none",
                 text = element_text(size = 20),
                 axis.text.x = element_text(size = 20),
                 axis.text.y = element_text(size = 20),
                 axis.title = element_text(size = 25),
                 axis.title.x = element_text(margin = margin(t = 20)),
                 axis.title.y = element_text(margin = margin(t = 10)),
                 plot.margin = unit(c(1,1,1,1), "cm"),
                 panel.grid = element_blank(),#hide the line in background
                 strip.background = element_rect(color = "black", fill = "white", size = 1)
                 ) +
  ggplot2::labs(y = "Split-Half Reliability", x = "Indices") +
  ggplot2::scale_fill_manual(values = c(palette$warm, palette$cold)) + 
  ggplot2::facet_wrap(~Target + Method, ncol = 3) 

names(plot)[1] <- "First-Second, Odd-Even, Permuted"

rm(nmshr.fake)

ggsave(filename="../FIGURE/Fig1_NM_SHR.png", width = 30, height = 10, dpi = 300)
```

```{r Plot SHR for Simulated Data, message= FALSE, warning = FALSE}
# only for testing codes
mcshr.fake <- read.csv("../OUTPUT/plot_mcshr_fake.csv") %>%
  dplyr::group_by(Indice, Target) %>%
  dplyr::arrange(r) %>%
  dplyr::mutate(Order = row_number()) %>%
  dplyr::ungroup() %>%
  dplyr::mutate(Indice = factor(Indice, levels = c("ezDDM: z", "ezDDM: v", "Efficiency", "Dprime", "ACC", "RT"))) %>%
  dplyr::arrange(Indice, Target, r)

plot[[2]] <- ggplot(mcshr.fake, aes(x = Indice, y = r, group = Order, color = interaction(Indice, Target))) +
  ggplot2::geom_errorbar(aes(ymin = LLCI, ymax = ULCI), width = 0.1, size = 2, position = position_dodge(width = 1)) +
  #geom_line() +
  ggplot2::geom_point(size = 5, position = position_dodge(width = 1)) +
  ggplot2::coord_flip() + #flips the x and y axes of a plot
  ggplot2::scale_y_continuous(limits = c(0, 1), 
                              sec.axis = sec_axis(~., breaks = c(0.3, 0.5, 0.7, 1), 
                                                  labels = c("unacceptable", "poor","acceptable", "excellent")),
                              breaks = seq(0,1,by = 0.1)) +
  ggplot2::geom_hline(yintercept = 0.3, linetype = "dotted", color = "black", size = 1, alpha = 0.5) + 
  ggplot2::geom_hline(yintercept = 0.5, linetype = "dotted", color = "black", size = 1, alpha = 0.5) + 
  ggplot2::geom_hline(yintercept = 0.7, linetype = "dotted", color = "black", size = 1, alpha = 0.5) +
  ggplot2::geom_hline(yintercept = 1, linetype = "dotted", color = "black", size = 1, alpha = 0.5) +
  ggplot2::theme_bw() +
  ggplot2::theme(legend.position = "none",
                 text = element_text(size = 20),
                 axis.text.x = element_text(size = 20),
                 axis.text.y = element_text(size = 20),
                 axis.title = element_text(size = 25),
                 axis.title.x = element_text(margin = margin(t = 20)),
                 axis.title.y = element_text(margin = margin(t = 10)),
                 plot.margin = unit(c(1,1,1,1), "cm"),
                 panel.grid = element_blank(),#hide the line in background
                 strip.background = element_rect(color = "black", fill = "white", size = 1)
                 ) +
  ggplot2::labs(y = "Monte Carlo-based Split-Half Reliability", x = "Indices") +
  ggplot2::scale_color_manual(values = c("black","black","black","black","black","black","grey","grey","grey","grey","grey","grey")) + 
  ggplot2::facet_wrap(~Target, ncol = 2) 

names(plot)[2] <- "Monte Carlo"

rm(mcshr.fake)

ggsave(filename="../FIGURE/Fig2_MC_SHR.png", width = 20, height = 15)
```

# ICC
```{r Plot ICC, message= FALSE, warning = FALSE}
# only for testing codes
icc.fake <- read.csv("../OUTPUT/plot_icc_fake.csv")

plot[[3]] <- ggplot2::ggplot(icc.fake, aes(x = ICC_type, y = ICC, color = interaction(ICC_type, Target))) +
  ggplot2::geom_errorbar(aes(ymin = LLCI, ymax = ULCI), width = 0.1, size = 2) +
  ggplot2::geom_point(size = 5) +
  ggplot2::coord_flip() + #flips the x and y axes of a plot
  ggplot2::scale_x_discrete() +
  ggplot2::scale_y_continuous(limits = c(0, 1), 
                     sec.axis = sec_axis(~., breaks = c(0.3, 0.5, 0.7, 1), 
                                             labels = c("unacceptable", "poor", "acceptable", "excellent")),
                                             breaks = seq(0,1,by = 0.1)) +
  ggplot2::geom_hline(yintercept = 0.3, linetype = "dotted", color = "black", size = 1, alpha = 0.5) + #add dotted line
  ggplot2::geom_hline(yintercept = 0.5, linetype = "dotted", color = "black", size = 1, alpha = 0.5) +
  ggplot2::geom_hline(yintercept = 0.7, linetype = "dotted", color = "black", size = 1, alpha = 0.5) +
  ggplot2::geom_hline(yintercept = 1, linetype = "dotted", color = "black", size = 1, alpha = 0.5) +
  ggplot2::theme_bw() +
  ggplot2::theme(text = element_text(size = 20),
                 axis.text.x = element_text(size = 20),
                 axis.text.y = element_text(size = 20),
                 axis.title = element_text(size = 25),
                 axis.title.x = element_text(margin = margin(t = 20)),
                 axis.title.y = element_text(margin = margin(t = 10)),
                 plot.title = element_text(size = 25),
                 plot.margin = unit(c(1,1,1,1), "cm"),
                 legend.key.size = unit(2, "cm"), 
                 legend.text = element_text(size = 20),
                 legend.title = element_blank(),
                 legend.position = "none",
                 panel.spacing = unit(4, "lines"),
                 panel.grid = element_blank(),#hide the line in background
                 strip.text = element_text(size = 20),
                 strip.background = element_rect(color="black", fill="white", size=1)
                 ) +
  ggplot2::labs(y = "Intraclass Correlation Coefficient", x = "Indices") +
  ggplot2::scale_color_manual(values = c(palette$warm, palette$cold)) + 
  ggplot2::facet_wrap(~ type + Target, ncol = 1) 

names(plot)[3] <- "ICC"

rm(icc.fake)

ggsave(filename="../FIGURE/Fig3_ICC.png", width = 15, height = 20, dpi = 300)
```