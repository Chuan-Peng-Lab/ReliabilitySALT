---
title: "4_IntraClass Correlation"
author: "yuki"
date: "2023-04-30"
output: html_document
---
# Create NULL list
```{r ICC List}
iccl <- list(list(), list())
names(iccl)[1] <- "Self - Friend"
names(iccl)[2] <- "Self - Stranger"

res[[3]] <- list()
names(res)[3] <- "ICC"
```

# ICC: Self - Friend
## df[[1]]: P0E1, df[[4]]: P51E1, df[[19]]Ps2E1
```{r Self - Friend}
df_rt <- yukiBP::icc(df = df[[4]], Indice = "rt", Target = "Celebrity")
df_acc <- yukiBP::icc(df = df[[4]], Indice = "acc", Target = "Celebrity")
df_dp <- yukiBP::icc(df = df[[4]], Indice = "dp", Target = "Celebrity")
df_eff <- yukiBP::icc(df = df[[4]], Indice = "eff", Target = "Celebrity")
df_ezddm <- yukiBP::icc(df = df[[4]], Indice = "ezddm", Target = "Celebrity")
df_ezddmv <- df_ezddm[[1]]
df_ezddmz <- df_ezddm[[2]]
df_rwddm <- yukiBP::icc(df = df[[4]], Indice = "rwddm", Target = "Celebrity")
df_rwddmv <- df_rwddm[[1]]
df_rwddmz <- df_rwddm[[2]]
```

```{r DF for Plot ICC}
iccl[[1]] <- list(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz)

rm(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz)
```

```{r DF for Plot ICC}
res[[3]][[1]] <- icc_output(list = iccl[[1]], Target = "Celebrity") %>%
  dplyr::filter(type == "ICC2" | type == "ICC2k")
names(res[[3]])[1] <- "Self - Celebrity"
```

```{r Save icc_friend}
write.csv(x = res[[3]][[1]],
          file = "./OUTPUT/icc_P51E1_celebrity.csv",
          row.names = FALSE,
          )
```


--------------------------------------------------------------------------------

# ICC: Self - Stranger
```{r Self - Stranger}
df_rt <- yukiBP::icc(df = df[[19]], Indice = "rt", Target = "Stranger")
df_acc <- yukiBP::icc(df = df[[19]], Indice = "acc", Target = "Stranger")
df_dp <- yukiBP::icc(df = df[[19]], Indice = "dp", Target = "Stranger")
df_eff <- yukiBP::icc(df = df[[19]], Indice = "eff", Target = "Stranger")
df_ezddm <- yukiBP::icc(df = df[[19]], Indice = "ezddm", Target = "Stranger")
df_ezddmv <- df_ezddm[[1]]
df_ezddmz <- df_ezddm[[2]]
df_rwddm <- yukiBP::icc(df = df[[19]], Indice = "rwddm", Target = "Stranger")
df_rwddmv <- df_rwddm[[1]]
df_rwddmz <- df_rwddm[[2]]
```

```{r DF for Plot ICC}
iccl[[2]] <- list(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz)

rm(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz)
```

```{r DF for Plot ICC}
res[[3]][[2]] <- icc_output(list = iccl[[2]], Target = "Stranger") %>%
  dplyr::filter(type == "ICC2" | type == "ICC2k")
names(res[[3]])[2] <- "Self - Stranger"
```

```{r Save icc_stranger}
write.csv(x = res[[3]][[2]],
          file = "./OUTPUT/icc_Ps2E1_stranger.csv",
          row.names = FALSE,
          )
```