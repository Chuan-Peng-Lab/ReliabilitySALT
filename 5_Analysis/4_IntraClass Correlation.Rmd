---
title: "4_IntraClass Correlation"
author: "yuki"
date: "2023-04-30"
output: html_document
---
# Create NULL list
```{r ICC List}
iccl <- list(list(), list())
names(iccl)[1] <- "Self - Friend"
names(iccl)[2] <- "Self - Stranger"

iccl_ReX <- list(list(), list())
names(iccl_ReX)[1] <- "Self - Friend"
names(iccl_ReX)[2] <- "Self - Stranger"

res[[3]] <- list()
names(res)[3] <- "ICC"
```

# ICC: Self - Friend
```{r Self - Friend}
df_rt <- yukiBP::icc(df = df[[1]], Indice = "rt", Target = "Friend")
df_acc <- yukiBP::icc(df = df[[1]], Indice = "acc", Target = "Friend")
df_dp <- yukiBP::icc(df = df[[1]], Indice = "dp", Target = "Friend")
df_eff <- yukiBP::icc(df = df[[1]], Indice = "eff", Target = "Friend")
df_ezddm <- yukiBP::icc(df = df[[1]], Indice = "ezddm", Target = "Friend")
df_ezddmv <- df_ezddm[[1]]
df_ezddmz <- df_ezddm[[2]]
df_rwddm <- yukiBP::icc(df = df[[1]], Indice = "rwddm", Target = "Friend")
df_rwddmv <- df_rwddm[[1]]
df_rwddmz <- df_rwddm[[2]]
```

```{r DF for Plot ICC}
iccl[[1]] <- list(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz) # nolint

names(iccl[[1]])[1] <- "RT"
names(iccl[[1]])[2] <- "ACC"
names(iccl[[1]])[3] <- "d"
names(iccl[[1]])[4] <- "η"
names(iccl[[1]])[5] <- "v(hausekeep)"
names(iccl[[1]])[6] <- "z(hausekeep)"
names(iccl[[1]])[7] <- "v(RWiener)"
names(iccl[[1]])[8] <- "z(RWiener)"

rm(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz, df_ezddm, df_rwddm)
```

```{r}
for (i in 1:length(iccl[[1]])) {
  iccl_ReX[[1]][[i]] <- iccl[[1]][[i]] %>%
    dplyr::mutate(
      Subject = row_number()
    ) %>%
    dplyr::rename(
      Session_1 = 1,
      Session_2 = 2,
      Session_3 = 3,
      Session_4 = 4,
      Session_5 = 5,
      Session_6 = 6,
    ) %>%
    tidyr::pivot_longer(
      cols = starts_with("Session_"),
      names_to = "Session",
      values_to = "SPE"
    ) %>%
    dplyr::rename(
     !!names(iccl[[1]])[i] := SPE
    ) 
}

res[[3]][[1]] <- base::do.call(data.frame, iccl_ReX[[1]]) %>%
  dplyr::select(
    Subject, Session,
    RT, ACC, 
    d, η, 
    v.hausekeep., z.hausekeep.,
    v.RWiener., z.RWiener.
  ) %>%
  dplyr::mutate_at(
    vars(3:10), base::scale
  )

Data <- as.matrix(res[[3]][[1]][,3:10])
Subject <- as.matrix(res[[3]][[1]][,"Subject"])        
Session <- as.matrix(res[[3]][[1]][,"Session"])         

res[[3]][[1]] <- data.frame(
  ReX::lme_ICC_1wayR(
    Data,
    Subject,
    Session
  )
)

rm(Data, Subject, Session)

write.csv(
  x = res[[3]][[1]],
  "./OUTPUT/icc_ReX_P0E1_Friend.csv",
  row.names = TRUE
)
```


--------------------------------------------------------------------------------

# ICC: Self - Stranger
```{r Self - Stranger}
df_rt <- yukiBP::icc(df = df[[1]], Indice = "rt", Target = "Stranger")
df_acc <- yukiBP::icc(df = df[[1]], Indice = "acc", Target = "Stranger")
df_dp <- yukiBP::icc(df = df[[1]], Indice = "dp", Target = "Stranger")
df_eff <- yukiBP::icc(df = df[[1]], Indice = "eff", Target = "Stranger")
df_ezddm <- yukiBP::icc(df = df[[1]], Indice = "ezddm", Target = "Stranger")
df_ezddmv <- df_ezddm[[1]]
df_ezddmz <- df_ezddm[[2]]
df_rwddm <- yukiBP::icc(df = df[[1]], Indice = "rwddm", Target = "Stranger")
df_rwddmv <- df_rwddm[[1]]
df_rwddmz <- df_rwddm[[2]]
```

```{r DF for Plot ICC}
iccl[[2]] <- list(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz) # nolint

names(iccl[[2]])[1] <- "RT"
names(iccl[[2]])[2] <- "ACC"
names(iccl[[2]])[3] <- "d"
names(iccl[[2]])[4] <- "η"
names(iccl[[2]])[5] <- "v(hausekeep)"
names(iccl[[2]])[6] <- "z(hausekeep)"
names(iccl[[2]])[7] <- "v(RWiener)"
names(iccl[[2]])[8] <- "z(RWiener)"

rm(df_rt, df_acc, df_dp, df_eff, df_ezddmv, df_ezddmz, df_rwddmv, df_rwddmz)
```

```{r}
for (i in 1:length(iccl[[2]])) {
  iccl_ReX[[2]][[i]] <- iccl[[2]][[i]] %>%
    dplyr::mutate(
      Subject = row_number()
    ) %>%
    dplyr::rename(
      Session_1 = 1,
      Session_2 = 2,
      Session_3 = 3,
      Session_4 = 4,
      Session_5 = 5,
      Session_6 = 6,
    ) %>%
    tidyr::pivot_longer(
      cols = starts_with("Session_"),
      names_to = "Session",
      values_to = "SPE"
    ) %>%
    dplyr::rename(
     !!names(iccl[[2]])[i] := SPE
    ) 
}

res[[3]][[2]] <- base::do.call(data.frame, iccl_ReX[[2]]) %>%
  dplyr::select(
    Subject, Session,
    RT, ACC, 
    d, η, 
    v.hausekeep., z.hausekeep.,
    v.RWiener., z.RWiener.
  ) %>%
  dplyr::mutate_at(
    vars(3:10), base::scale
  )

Data <- as.matrix(res[[3]][[2]][,3:10])
Subject <- as.matrix(res[[3]][[2]][,"Subject"])        
Session <- as.matrix(res[[3]][[2]][,"Session"])         

res[[3]][[2]] <- data.frame(
  ReX::lme_ICC_1wayR(
    Data,
    Subject,
    Session
  )
)

rm(Data, Subject, Session)

write.csv(
  x = res[[3]][[2]],
  "./OUTPUT/icc_ReX_P0E1_Stranger.csv",
  row.names = TRUE
)
```