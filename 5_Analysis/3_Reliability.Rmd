---
title: "3_Reliability"
author: "yuki"
date: "2023-04-30"
output: html_document
---
# Create NULL List
```{r Create NULL List}
res <- list()
```

# First-Second, Odd-Even, Permuted
```{r Name Self - Friend}
res[[1]] <- list()
names(res)[1] <- "First-Second, Odd-Even, Permuted"
```

## Self - Friend
```{r RT, message=FALSE, warning=FALSE}
df.rt <- batch::shr(list = shl[1:3], indice = "rt", Target = "Friend", Paper_ID = "P95E2", mc = FALSE, nc = NULL)

df.acc <-batch::shr(list = shl[1:3], indice = "acc", Target = "Friend", Paper_ID = "P95E2", mc = FALSE, nc = NULL)

df.dp <- batch::shr(list = shl[1:3], indice = "dp", Target = "Friend", Paper_ID = "P95E2", mc = FALSE, nc = NULL)

df.eff <- batch::shr(list = shl[1:3], indice = "eff", Target = "Friend", Paper_ID = "P95E2", mc = FALSE, nc = NULL)
```

```{r Rbind 6 Indices}
res[[1]][[1]] <- rbind(df.rt, df.acc, df.dp, df.eff)
res[[1]][[1]] <- res[[1]][[1]] %>%
  dplyr::mutate(Indice = .$X1, Method = .$X2, r = .$X3, Target = .$V4, Paper_ID = .$V5) %>%
  dplyr::mutate(Method = case_when(Method == 1 ~ "First-Second", Method == 2 ~ "Odd-Even", Method == 3 ~ "Permuted")) %>%
  dplyr::select(Indice, Method, r, Target, Paper_ID)

rownames(res[[1]][[1]]) <- NULL
names(res[[1]])[1] <- "Self - Partner"
rm(df.rt, df.acc, df.dp, df.eff)
```

```{r Save nmshr_friend}
write.csv(res[[1]][[1]], "./OUTPUT/nmshr_P95E2_friend.csv", row.names = FALSE)
```

## Self - Stranger
```{r RT, message=FALSE, warning=FALSE}
df.rt <- batch::shr(list = shl[1:3], indice = "rt", Target = "Stranger", Paper_ID = "Ps1E1", mc = FALSE, nc = NULL)

df.acc <-batch::shr(list = shl[1:3], indice = "acc", Target = "Stranger", Paper_ID = "Ps1E1", mc = FALSE, nc = NULL)

df.dp <- batch::shr(list = shl[1:3], indice = "dp", Target = "Stranger", Paper_ID = "Ps1E1", mc = FALSE, nc = NULL)

df.eff <- batch::shr(list = shl[1:3], indice = "eff", Target = "Stranger", Paper_ID = "Ps1E1", mc = FALSE, nc = NULL)
```

```{r Rbind 6 Indices}
res[[1]][[2]] <- rbind(df.rt, df.acc, df.dp, df.eff)
res[[1]][[2]] <- res[[1]][[2]] %>%
  dplyr::mutate(Indice = .$X1, Method = .$X2, r = .$X3, Target = .$V4, Paper_ID = .$V5) %>%
  dplyr::mutate(Method = case_when(Method == 1 ~ "First-Second", Method == 2 ~ "Odd-Even", Method == 3 ~ "Permuted")) %>%
  dplyr::select(Indice, Method, r, Target, Paper_ID)

rownames(res[[1]][[2]]) <- NULL
names(res[[1]])[2] <- "Self - Stranger"
rm(df.rt, df.acc, df.dp, df.eff)
```

```{r Save nmshr_stranger}
write.csv(res[[1]][[2]], "./OUTPUT/nmshr_Ps1E1_stranger.csv", row.names = FALSE)
```


# Monte Carlo
```{r Name Self - Friend}
res[[2]] <- list()
names(res)[2] <- "Monte Carlo"
```

## Self - Friend
```{r RT, message=FALSE, warning=FALSE}
df.rt <- batch::shr(list = shl[[4]], indice = "rt", Target = "Friend", Paper_ID = "P0E1", mc = TRUE)

df.acc <- batch::shr(list = shl[[4]], indice = "acc", Target = "Friend", Paper_ID = "P0E1", mc = TRUE)

df.dp <- batch::shr(list = shl[[4]], indice = "dp", Target = "Friend", Paper_ID = "P0E1", mc = TRUE)

df.eff <- batch::shr(list = shl[[4]], indice = "eff", Target = "Friend", Paper_ID = "P0E1", mc = TRUE)
```

```{r Rbind 6 Indices}
res[[2]][[1]] <- rbind(df.rt, df.acc, df.dp, df.eff)
rownames(res[[2]][[1]]) <- NULL
names(res[[2]])[1] <- "Self - Friend"
rm(df.rt, df.acc, df.dp, df.eff)
```

```{r Save mcshr_friend}
write.csv(res[[2]][[1]], "./OUTPUT/mcshr_P0E1_friend.csv", row.names = FALSE)
```

## Self - Stranger
```{r RT, message=FALSE, warning=FALSE}
df.rt <- batch::shr(list = shl[[4]], indice = "rt", Target = "Stranger", Paper_ID = "P0E1", mc = TRUE, nc = 16)

df.acc <- batch::shr(list = shl[[4]], indice = "acc", Target = "Stranger", Paper_ID = "P0E1", mc = TRUE, nc = 16)

df.dp <- batch::shr(list = shl[[4]], indice = "dp", Target = "Stranger", Paper_ID = "P0E1", mc = TRUE, nc = 16)

df.eff <- batch::shr(list = shl[[4]], indice = "eff", Target = "Stranger", Paper_ID = "P0E1", mc = TRUE, nc = 16)
```

```{r Rbind 6 Indices}
res[[2]][[2]] <- rbind(df.rt, df.acc, df.dp, df.eff)
rownames(res[[2]][[2]]) <- NULL
names(res[[2]])[2] <- "Self - Stranger"
rm(df.rt, df.acc, df.dp, df.eff)
```

```{r Save mcshr_stranger}
write.csv(res[[2]][[2]], "./OUTPUT/mcshr_P0E1_stranger.csv", row.names = FALSE)
```